"use strict";var P=Object.defineProperty;var h=(e,s,a)=>s in e?P(e,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[s]=a;var o=(e,s,a)=>(h(e,typeof s!="symbol"?s+"":s,a),a);const l=require("electron"),c=require("path"),D=require("url");var E=typeof document<"u"?document.currentScript:null;const _="poem-interaction",R="1.0.0",p=c.dirname(D.fileURLToPath(typeof document>"u"?require("url").pathToFileURL(__filename).href:E&&E.src||new URL("index.js",document.baseURI).href));class t{}o(t,"APP_NAME",_.charAt(0).toUpperCase()+_.slice(1)),o(t,"APP_VERSION",R),o(t,"IS_DEV_ENV",process.env.NODE_ENV==="development"),o(t,"IS_MAC",process.platform==="darwin"),o(t,"DEFAULT_WEB_PREFERENCES",{nodeIntegration:!1,contextIsolation:!0,enableRemoteModule:!1,preload:c.join(p,"../preload/index.js")}),o(t,"APP_INDEX_URL_DEV","http://localhost:5173/index.html"),o(t,"APP_INDEX_URL_PROD",c.join(p,"../index.html"));class V{static initialize(){l.ipcMain.handle("msgRequestGetVersion",()=>t.APP_VERSION),l.ipcMain.on("msgOpenExternalLink",async(s,a)=>{await l.shell.openExternal(a)}),l.ipcMain.handle("msgOpenFile",async(s,a)=>{const i=[];return a==="text"?i.push({name:"Text",extensions:["txt","json"]}):a==="zip"&&i.push({name:"Zip",extensions:["zip"]}),await l.dialog.showOpenDialog({properties:["openFile"],filters:i})})}}const N=e=>{e&&!e.isDestroyed()&&e.hide(),e.destroy(),l.app.exit()},u=async e=>(e=new l.BrowserWindow({title:t.APP_NAME,show:!1,width:(t.IS_DEV_ENV,1270),height:720,useContentSize:!0,webPreferences:t.DEFAULT_WEB_PREFERENCES}),e.setMenu(null),e.on("close",s=>{s.preventDefault(),N(e)}),e.webContents.on("did-frame-finish-load",()=>{t.IS_DEV_ENV&&e.webContents.openDevTools()}),e.once("ready-to-show",()=>{e.setAlwaysOnTop(!0),e.show(),e.focus(),e.setAlwaysOnTop(!1)}),V.initialize(),t.IS_DEV_ENV?await e.loadURL(t.APP_INDEX_URL_DEV):await e.loadFile(t.APP_INDEX_URL_PROD),e),f=async(e,s,a)=>(t.IS_DEV_ENV||s==null||s.hide(),e=new l.BrowserWindow({title:t.APP_NAME,show:!1,resizable:t.IS_DEV_ENV,webPreferences:t.DEFAULT_WEB_PREFERENCES}),e.setMenu(null),t.IS_DEV_ENV?await e.loadURL(`${t.APP_INDEX_URL_DEV}#/error`):await e.loadFile(t.APP_INDEX_URL_PROD,{hash:"error"}),e.on("ready-to-show",()=>{!t.IS_DEV_ENV&&s&&!s.isDestroyed()&&s.destroy(),e.show(),e.focus()}),e.webContents.on("did-frame-finish-load",()=>{t.IS_DEV_ENV&&e.webContents.openDevTools()}),e);let n,r;l.app.on("ready",async()=>{t.IS_DEV_ENV&&Promise.resolve().then(()=>require("./index.dev-DtNy_td2.js")),n=await u(n)});l.app.on("activate",async()=>{n||(n=await u(n))});l.app.on("window-all-closed",()=>{n=null,r=null,t.IS_MAC||l.app.quit()});l.app.on("render-process-gone",(e,s,a)=>{r=f(r,n)});process.on("uncaughtException",()=>{r=f(r,n)});
